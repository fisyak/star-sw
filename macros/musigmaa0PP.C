#include "TMath.h"
#include "TF1.h"
#include "TROOT.h"
//________________________________________________________________________________
Double_t funFreqp2(Double_t *x, Double_t *par) {
  return TMath::Exp(par[0])*TMath::Freq(-(x[0]-par[1])*par[2])  + par[3] +  x[0]*(par[4] + x[0]*par[5]);
}
//________________________________________________________________________________
TF1 *FunFreqP2() {
  TF1 *f = (TF1*) gROOT->GetFunction("FunFreqP2");
  if (! f) {
    f = new TF1("FunFreqp2",funFreqp2,-1000,1000,6);
    f->SetParNames("Norm","#mu","1/#sigma","a[0]","a[1]","a[2]");
    f->SetParameters(0,208,1.,0);
    f->SetParLimits(0,-10,20);
    f->SetParLimits(1,-1000,1000);
    //    f->SetParLimits(2,0,10);
    f->SetParameters(0.0, 2.6, -3.0, -0.1, 0.0, 0.0);
  }
  return f;
}
//________________________________________________________________________________
Double_t musigmaa0PP(Double_t y, Int_t k = 0) {
  Double_t params[3][6] = {
    { // muPP
      /*   1  Norm      */  -1.77441e-01, //   8.82693e-03   6.40586e-07  -2.98707e-02
      /*   2  #mu       */   1.80245e+00, //   2.26143e-03  -1.16495e-09  -3.24056e+01
      /*   3  1/#sigma  */  -7.07624e+00, //   1.79139e-01   8.06792e-05  -1.44555e-04
      /*   4  a_0       */  -1.39000e-01, //   4.64931e-03  -2.09743e-06   2.38069e-03
      /*   5  a_1       */   0.00000e+00, //     fixed    
      /*   6  a_2       */   0.00000e+00  //     fixed    
    },
    { // sigmaPP
      /*   1  Norm      */   4.35779e-01, //    1.88577e-01  -5.60064e-04   6.35313e+02
      /*   2  #mu       */   3.28933e-01, //    2.26794e-01   6.43807e-06  -7.17664e+03
      /*   3  1/#sigma  */  -1.00429e+00, //    1.78688e-01  -1.08617e-03  -9.46120e+00
      /*   4  a_0       */  -1.28604e+00, //    2.95995e-01   1.26544e-02   3.09656e+01
      /*   5  a_1       */   0.00000e+00, //      fixed    
      /*   6  a_2       */   0.00000e+00  //      fixed    
    },
    { // 1/a0PP
      /*   1  Norm      */   6.30400e-01, //    3.14818e-02   1.84414e-06  -7.43473e-01
      /*   2  #mu       */   2.24644e+00, //    9.50555e-03   9.51151e-09   6.89059e+01
      /*   3  1/#sigma  */  -4.60961e+00, //    2.23460e-01   2.88208e-04   1.86186e-03
      /*   4  a_0       */  -2.45932e-01, //    2.01674e-02   2.20680e-05  -3.34694e-02
      /*   5  a_1       */   0.00000e+00, //      fixed    
      /*   6  a_2       */   0.00000e+00  //      fixed                                
    }
  };
  TF1 *f =    FunFreqP2();
  if (k < 0 || k > 2) return 0;
  if (y <= 1.0) return 0;
  Double_t yy = TMath::Log(TMath::Log(y));
  return f->EvalPar(&yy, params[k]);
}
