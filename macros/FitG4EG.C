static const Int_t Npart4EG = 6;
//________________________________________________________________________________
Double_t gf4EGFunc(Double_t *x, Double_t *par) {
  Double_t XX[1] = {x[0]};
  // par[0] - norm
  // par[1] - pion position wrt Z_pion (Bichsel prediction)
  // par[2] - sigma 
  // par[3] - proton signal  1
  // par[4] - Kaon    -"-    2
  // par[5] - electorn -"-   3
  // par[6] - deuteron -"-   4
  // par[7] - muon           5
  // par[8] - triton         6
  // par[9] - He3            7
  // par[10]- alpha          8
  // par[11] - Total
  // par[12] - case (-1 all, >-0 hyp no.)
  // par[13] - occupancy = probability to have 2d hits in the cluster 
  // par[14] - IO
  // par[15] - sign
  // par[16] - eLoss || Scale
  Double_t mu    = par[1];
  Double_t sigma = par[2];
  Double_t occupancy = par[13];
  Double_t scale = 1 + par[16];
  //  XX[0] *= scale;
  Int_t IO = par[14];
  IO = TMath::Max(0, TMath::Min(1, IO));
  Int_t sign = par[15];
  Double_t frac[9];
  Double_t ff[9] = {0};
  for (Int_t i = 1; i < 9; i++) {
    ff[i] = TMath::Sin(par[2+i]);
    ff[i] *= ff[i];
  }
  frac[1] = ff[1];
  //  frac[0] = (1 - frac[1])/(1. + ff[2] + ff[3] + ff[4]);
  frac[0] = (1 - ff[1]*(1 + ff[4] + ff[6] + ff[7] + ff[8]))/(1 + ff[2] + ff[3] + ff[5]);
  frac[2] = frac[0]*ff[2];
  frac[3] = frac[0]*ff[3];
  frac[4] = ff[1]*ff[4];
  frac[5] = frac[0]*ff[5];
  frac[6] = ff[1]*ff[6];
  frac[7] = ff[1]*ff[7];
  frac[8] = ff[1]*ff[8];
  if (frac[0] < 0.4 && frac[1] < 0.4) return 0;
  // 10/31/22    /hlt/cephfs/fisyak/TpcRS_2021.COL.100keV/dEdx3/Fit
  //                           P  S IO
  static MIPFitParG_t parMIPs[27][3][2] = {
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 0,-1, 0, 0,"zIpionN"                       ,    9.14142,   -0.21628,    2.54452,    0.45379,    1.00000},
	{ 0,-1, 0, 1,"zOpionN"                       ,    9.75809,   -0.24376,    2.94731,    0.72270,    1.00000} },{
	{ 0,-1, 1, 0,"zIpionP"                       ,    9.29170,   -0.25715,    2.57000,    0.48993,    1.00000},
	{ 0,-1, 1, 1,"zOpionP"                       ,    9.80002,   -0.26689,    2.93394,    0.74102,    1.00000} },{
	{ 0,-1, 2, 0,"zIpion"                        ,    9.91253,   -0.23821,    2.55491,    0.47355,    1.00000},
	{ 0,-1, 2, 1,"zOpion"                        ,   10.47574,   -0.25517,    2.93869,    0.73568,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 1,-1, 0, 0,"zIprotonN"                     ,   10.31367,    0.87248,    3.67609,    1.05217,    1.00000},
	{ 1,-1, 0, 1,"zOprotonN"                     ,   10.51738,    0.97325,    4.00515,    1.31405,    1.00000} },{
	{ 1,-1, 1, 0,"zIprotonP"                     ,   10.26744,    0.86346,    3.67953,    1.04595,    1.00000},
	{ 1,-1, 1, 1,"zOprotonP"                     ,   10.42140,    0.96872,    4.01845,    1.29871,    1.00000} },{
	{ 1,-1, 2, 0,"zIproton"                      ,   10.98971,    0.86826,    3.68369,    1.05309,    1.00000},
	{ 1,-1, 2, 1,"zOproton"                      ,   11.16469,    0.97114,    4.01164,    1.30737,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 2,-1, 0, 0,"zIkaonN"                       ,    9.63694,    0.13341,    2.93466,    0.58884,    1.00000},
	{ 2,-1, 0, 1,"zOkaonN"                       ,   10.07930,    0.16954,    3.33318,    0.86899,    1.00000} },{
	{ 2,-1, 1, 0,"zIkaonP"                       ,    9.66048,    0.10783,    2.95937,    0.60155,    1.00000},
	{ 2,-1, 1, 1,"zOkaonP"                       ,   10.00915,    0.15799,    3.31241,    0.87946,    1.00000} },{
	{ 2,-1, 2, 0,"zIkaon"                        ,   10.34618,    0.12068,    2.94741,    0.60081,    1.00000},
	{ 2,-1, 2, 1,"zOkaon"                        ,   10.74004,    0.16412,    3.32274,    0.87576,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 3,-1, 0, 0,"zIelectronN"                   ,    9.62711,    0.02036,    2.95747,    0.57639,    1.00000},
	{ 3,-1, 0, 1,"zOelectronN"                   ,   10.12671,    0.05269,    3.32954,    0.87497,    1.00000} },{
	{ 3,-1, 1, 0,"zIelectronP"                   ,    9.77843,   -0.00430,    2.96260,    0.63743,    1.00000},
	{ 3,-1, 1, 1,"zOelectronP"                   ,   10.17430,    0.04205,    3.31083,    0.90705,    1.00000} },{
	{ 3,-1, 2, 0,"zIelectron"                    ,   10.40735,    0.00811,    2.95602,    0.62028,    1.00000},
	{ 3,-1, 2, 1,"zOelectron"                    ,   10.84539,    0.04754,    3.31734,    0.89262,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 4,-1, 0, 0,""                              ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000},
	{ 4,-1, 0, 1,""                              ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000} },{
	{ 4,-1, 1, 0,"zIdeuteronP"                   ,    9.68242,    1.88943,    5.42909,    1.62022,    1.00000},
	{ 4,-1, 1, 1,"zOdeuteronP"                   ,    8.46010,    1.88133,    7.27942,    1.57080,    1.00000} },{
	{ 4,-1, 2, 0,"zIdeuteron"                    ,    9.68242,    1.88943,    5.42909,    1.62022,    1.00000},
	{ 4,-1, 2, 1,"zOdeuteron"                    ,    8.46010,    1.88133,    7.27942,    1.57080,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 5,-1, 0, 0,"zImuonN"                       ,    9.19539,   -0.21310,    2.56015,    0.44506,    1.00000},
	{ 5,-1, 0, 1,"zOmuonN"                       ,    9.79412,   -0.23633,    2.95445,    0.71725,    1.00000} },{
	{ 5,-1, 1, 0,"zImuonP"                       ,    9.29179,   -0.25293,    2.59072,    0.49283,    1.00000},
	{ 5,-1, 1, 1,"zOmuonP"                       ,    9.79974,   -0.25777,    2.95584,    0.74854,    1.00000} },{
	{ 5,-1, 2, 0,"zImuon"                        ,    9.93622,   -0.23402,    2.57271,    0.46765,    1.00000},
	{ 5,-1, 2, 1,"zOmuon"                        ,   10.49324,   -0.24664,    2.95269,    0.73644,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 0, 0, 0, 0,"zIpionN+zIpionN"               ,    9.11904,    0.56847,    3.12111,    0.38270,    1.00000},
	{ 0, 0, 0, 1,"zOpionN+zOpionN"               ,    9.84720,    0.52267,    3.72706,    0.76332,    1.00000} },{
	{ 0, 0, 1, 0,"zIpionP+zIpionP"               ,    9.24748,    0.52570,    3.14539,    0.38118,    1.00000},
	{ 0, 0, 1, 1,"zOpionP+zOpionP"               ,    9.82918,    0.49467,    3.71447,    0.72337,    1.00000} },{
	{ 0, 0, 2, 0,"zIpion+zIpion"                 ,    9.89534,    0.54543,    3.15510,    0.41585,    1.00000},
	{ 0, 0, 2, 1,"zOpion+zOpion"                 ,   10.50756,    0.50725,    3.72337,    0.72155,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 1, 0, 0, 0,"zIprotonN+zIpionN"             ,   10.22660,    1.22368,    4.03675,    0.96415,    1.00000},
	{ 1, 0, 0, 1,"zOprotonN+zOpionN"             ,   10.51738,    1.27439,    4.58011,    1.24215,    1.00000} },{
	{ 1, 0, 1, 0,"zIprotonP+zIpionP"             ,   10.20101,    1.20415,    4.09384,    0.97067,    1.00000},
	{ 1, 0, 1, 1,"zOprotonP+zOpionP"             ,   10.41013,    1.26534,    4.57627,    1.22501,    1.00000} },{
	{ 1, 0, 2, 0,"zIproton+zIpion"               ,   10.92672,    1.21296,    4.10062,    0.98012,    1.00000},
	{ 1, 0, 2, 1,"zOproton+zOpion"               ,   11.16402,    1.27034,    4.57770,    1.23790,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 1, 1, 0, 0,"zIprotonN+zIprotonN"           ,   10.57570,    1.61480,    4.82817,    1.13828,    1.00000},
	{ 1, 1, 0, 1,"zOprotonN+zOprotonN"           ,   10.84423,    1.70231,    5.24332,    1.39313,    1.00000} },{
	{ 1, 1, 1, 0,"zIprotonP+zIprotonP"           ,   10.52521,    1.60712,    4.80227,    1.13193,    1.00000},
	{ 1, 1, 1, 1,"zOprotonP+zOprotonP"           ,   10.75612,    1.69889,    5.22653,    1.38809,    1.00000} },{
	{ 1, 1, 2, 0,"zIproton+zIproton"             ,   11.25445,    1.61163,    4.82842,    1.14144,    1.00000},
	{ 1, 1, 2, 1,"zOproton+zOproton"             ,   11.49218,    1.70106,    5.23533,    1.38866,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 2, 0, 0, 0,"zIkaonN+zIpionN"               ,    9.56220,    0.74700,    3.40273,    0.46497,    1.00000},
	{ 2, 0, 0, 1,"zOkaonN+zOpionN"               ,   10.11094,    0.74092,    4.02823,    0.85345,    1.00000} },{
	{ 2, 0, 1, 0,"zIkaonP+zIpionP"               ,    9.60684,    0.71315,    3.45213,    0.51043,    1.00000},
	{ 2, 0, 1, 1,"zOkaonP+zOpionP"               ,   10.01144,    0.72299,    3.98696,    0.84044,    1.00000} },{
	{ 2, 0, 2, 0,"zIkaon+zIpion"                 ,   10.23504,    0.72679,    3.43510,    0.42266,    1.00000},
	{ 2, 0, 2, 1,"zOkaon+zOpion"                 ,   10.74996,    0.73223,    3.99391,    0.84337,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 2, 1, 0, 0,"zIkaonN+zIprotonN"             ,   10.12827,    1.31920,    4.28799,    0.95789,    1.00000},
	{ 2, 1, 0, 1,"zOkaonN+zOprotonN"             ,   10.80836,    1.38635,    4.80306,    1.25605,    1.00000} },{
	{ 2, 1, 1, 0,"zIkaonP+zIprotonP"             ,   10.15202,    1.30500,    4.29286,    0.96514,    1.00000},
	{ 2, 1, 1, 1,"zOkaonP+zOprotonP"             ,   10.70371,    1.38013,    4.79708,    1.24224,    1.00000} },{
	{ 2, 1, 2, 0,"zIkaon+zIproton"               ,   10.85041,    1.31242,    4.29101,    0.97323,    1.00000},
	{ 2, 1, 2, 1,"zOkaon+zOproton"               ,   11.45380,    1.38252,    4.81032,    1.25101,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 2, 2, 0, 0,"zIkaonN+zIkaonN"               ,    9.63031,    0.89992,    3.66934,    0.54954,    1.00000},
	{ 2, 2, 0, 1,"zOkaonN+zOkaonN"               ,   10.20806,    0.92085,    4.28177,    0.91285,    1.00000} },{
	{ 2, 2, 1, 0,"zIkaonP+zIkaonP"               ,    9.65557,    0.87351,    3.69460,    0.56340,    1.00000},
	{ 2, 2, 1, 1,"zOkaonP+zOkaonP"               ,   10.12056,    0.90823,    4.26136,    0.90920,    1.00000} },{
	{ 2, 2, 2, 0,"zIkaon+zIkaon"                 ,   10.36532,    0.88678,    3.72092,    0.59209,    1.00000},
	{ 2, 2, 2, 1,"zOkaon+zOkaon"                 ,   10.87472,    0.91549,    4.28186,    0.92222,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 3, 0, 0, 0,"zIelectronN+zIpionN"           ,    9.55700,    0.68375,    3.40616,    0.45703,    1.00000},
	{ 3, 0, 0, 1,"zOelectronN+zOpionN"           ,   10.16372,    0.67439,    4.02091,    0.86299,    1.00000} },{
	{ 3, 0, 1, 0,"zIelectronP+zIpionP"           ,    9.68348,    0.64807,    3.47008,    0.49330,    1.00000},
	{ 3, 0, 1, 1,"zOelectronP+zOpionP"           ,   10.18801,    0.65639,    3.99877,    0.87350,    1.00000} },{
	{ 3, 0, 2, 0,"zIelectron+zIpion"             ,   10.32948,    0.66538,    3.43078,    0.49720,    1.00000},
	{ 3, 0, 2, 1,"zOelectron+zOpion"             ,   10.84347,    0.66395,    4.01456,    0.84859,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 3, 1, 0, 0,"zIelectronN+zIprotonN"         ,   10.22296,    1.28682,    4.29842,    1.02079,    1.00000},
	{ 3, 1, 0, 1,"zOelectronN+zOprotonN"         ,   10.88211,    1.35323,    4.77506,    1.27950,    1.00000} },{
	{ 3, 1, 1, 0,"zIelectronP+zIprotonP"         ,   10.33967,    1.27200,    4.33172,    1.02983,    1.00000},
	{ 3, 1, 1, 1,"zOelectronP+zOprotonP"         ,   10.89640,    1.34854,    4.76228,    1.28250,    1.00000} },{
	{ 3, 1, 2, 0,"zIelectron+zIproton"           ,   10.98103,    1.28074,    4.30748,    1.02895,    1.00000},
	{ 3, 1, 2, 1,"zOelectron+zOproton"           ,   11.57645,    1.34924,    4.77131,    1.27665,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 3, 2, 0, 0,"zIelectronN+zIkaonN"           ,    9.68949,    0.84762,    3.70208,    0.61789,    1.00000},
	{ 3, 2, 0, 1,"zOelectronN+zOkaonN"           ,   10.23821,    0.86318,    4.29569,    0.90470,    1.00000} },{
	{ 3, 2, 1, 0,"zIelectronP+zIkaonP"           ,    9.78248,    0.81895,    3.72418,    0.60666,    1.00000},
	{ 3, 2, 1, 1,"zOelectronP+zOkaonP"           ,   10.24795,    0.84941,    4.26589,    0.90483,    1.00000} },{
	{ 3, 2, 2, 0,"zIelectron+zIkaon"             ,   10.38546,    0.83122,    3.71052,    0.56133,    1.00000},
	{ 3, 2, 2, 1,"zOelectron+zOkaon"             ,   10.96045,    0.85782,    4.27403,    0.92218,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 3, 3, 0, 0,"zIelectronN+zIelectronN"       ,    9.66196,    0.78995,    3.72340,    0.58801,    1.00000},
	{ 3, 3, 0, 1,"zOelectronN+zOelectronN"       ,   10.30024,    0.80689,    4.29393,    0.94830,    1.00000} },{
	{ 3, 3, 1, 0,"zIelectronP+zIelectronP"       ,    9.82908,    0.76339,    3.73965,    0.65719,    1.00000},
	{ 3, 3, 1, 1,"zOelectronP+zOelectronP"       ,   10.32619,    0.79325,    4.27601,    0.95907,    1.00000} },{
	{ 3, 3, 2, 0,"zIelectron+zIelectron"         ,   10.42680,    0.77502,    3.74200,    0.60922,    1.00000},
	{ 3, 3, 2, 1,"zOelectron+zOelectron"         ,   11.00633,    0.80062,    4.28333,    0.95391,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 4, 0, 0, 0,""                              ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000},
	{ 4, 0, 0, 1,""                              ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000} },{
	{ 4, 0, 1, 0,"zIdeuteronP+zIpionP"           ,    9.64523,    2.03234,    5.65867,    1.42861,    1.00000},
	{ 4, 0, 1, 1,"zOdeuteronP+zOpionP"           ,    8.41461,    2.01650,    7.31553,    1.47382,    1.00000} },{
	{ 4, 0, 2, 0,"zIdeuteron+zIpion"             ,    9.61392,    2.03084,    5.68875,    1.40032,    1.00000},
	{ 4, 0, 2, 1,"zOdeuteron+zOpion"             ,    8.42454,    2.01807,    7.33704,    1.48393,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 4, 1, 0, 0,""                              ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000},
	{ 4, 1, 0, 1,""                              ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000} },{
	{ 4, 1, 1, 0,"zIdeuteronP+zIprotonP"         ,    9.73549,    2.22523,    6.17298,    1.43775,    1.00000},
	{ 4, 1, 1, 1,"zOdeuteronP+zOprotonP"         ,    8.48654,    2.23596,    7.67219,    1.49681,    1.00000} },{
	{ 4, 1, 2, 0,"zIdeuteron+zIproton"           ,    9.72457,    2.22487,    6.15565,    1.43100,    1.00000},
	{ 4, 1, 2, 1,"zOdeuteron+zOproton"           ,    8.47633,    2.23442,    7.73429,    1.48080,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 4, 2, 0, 0,""                              ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000},
	{ 4, 2, 0, 1,""                              ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000} },{
	{ 4, 2, 1, 0,"zIdeuteronP+zIkaonP"           ,    9.64475,    2.07634,    5.78030,    1.41294,    1.00000},
	{ 4, 2, 1, 1,"zOdeuteronP+zOkaonP"           ,    8.43029,    2.07354,    7.33849,    1.48361,    1.00000} },{
	{ 4, 2, 2, 0,"zIdeuteron+zIkaon"             ,    9.65300,    2.07878,    5.77475,    1.42034,    1.00000},
	{ 4, 2, 2, 1,"zOdeuteron+zOkaon"             ,    8.41406,    2.06944,    7.53880,    1.45103,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 4, 3, 0, 0,""                              ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000},
	{ 4, 3, 0, 1,""                              ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000} },{
	{ 4, 3, 1, 0,"zIdeuteronP+zIelectronP"       ,    9.68343,    2.05773,    5.82941,    1.43788,    1.00000},
	{ 4, 3, 1, 1,"zOdeuteronP+zOelectronP"       ,    8.46226,    2.05391,    7.51260,    1.49538,    1.00000} },{
	{ 4, 3, 2, 0,"zIdeuteron+zIelectron"         ,    9.68187,    2.06223,    5.76550,    1.44483,    1.00000},
	{ 4, 3, 2, 1,"zOdeuteron+zOelectron"         ,    8.46554,    2.05224,    7.56544,    1.65002,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 4, 4, 0, 0,""                              ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000},
	{ 4, 4, 0, 1,""                              ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000} },{
	{ 4, 4, 1, 0,"zIdeuteronP+zIdeuteronP"       ,   10.00785,    2.59098,    7.47962,    1.53821,    1.00000},
	{ 4, 4, 1, 1,"zOdeuteronP+zOdeuteronP"       ,    8.77993,    2.57945,   10.00000,    1.57080,    1.00000} },{
	{ 4, 4, 2, 0,"zIdeuteron+zIdeuteron"         ,   10.01160,    2.59161,    7.52530,    1.60747,    1.00000},
	{ 4, 4, 2, 1,"zOdeuteron+zOdeuteron"         ,    8.77413,    2.57892,    9.93971,    1.57080,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 5, 0, 0, 0,"zImuonN+zIpionN"               ,    9.18822,    0.57110,    3.15029,    0.40675,    1.00000},
	{ 5, 0, 0, 1,"zOmuonN+zOpionN"               ,    9.84548,    0.52308,    3.73651,    0.72425,    1.00000} },{
	{ 5, 0, 1, 0,"zImuonP+zIpionP"               ,    9.28208,    0.52729,    3.18523,    0.44772,    1.00000},
	{ 5, 0, 1, 1,"zOmuonP+zOpionP"               ,    9.81902,    0.49927,    3.73471,    0.72195,    1.00000} },{
	{ 5, 0, 2, 0,"zImuon+zIpion"                 ,    9.93517,    0.54857,    3.15743,    0.43884,    1.00000},
	{ 5, 0, 2, 1,"zOmuon+zOpion"                 ,   10.51158,    0.51058,    3.73187,    0.71039,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 5, 1, 0, 0,"zImuonN+zIprotonN"             ,    9.79394,    1.22356,    4.06043,    0.96890,    1.00000},
	{ 5, 1, 0, 1,"zOmuonN+zOprotonN"             ,   10.65280,    1.27646,    4.59912,    1.23759,    1.00000} },{
	{ 5, 1, 1, 0,"zImuonP+zIprotonP"             ,    9.85416,    1.20372,    4.08162,    0.96283,    1.00000},
	{ 5, 1, 1, 1,"zOmuonP+zOprotonP"             ,   10.63993,    1.26953,    4.59536,    1.24528,    1.00000} },{
	{ 5, 1, 2, 0,"zImuon+zIproton"               ,   10.49623,    1.21185,    4.08678,    0.94996,    1.00000},
	{ 5, 1, 2, 1,"zOmuon+zOproton"               ,   11.33064,    1.27190,    4.57985,    1.23708,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 5, 2, 0, 0,"zImuonN+zIkaonN"               ,    9.29526,    0.75297,    3.42458,    0.55477,    1.00000},
	{ 5, 2, 0, 1,"zOmuonN+zOkaonN"               ,    9.99806,    0.74357,    4.03146,    0.84110,    1.00000} },{
	{ 5, 2, 1, 0,"zImuonP+zIkaonP"               ,    9.29833,    0.71470,    3.44825,    0.46374,    1.00000},
	{ 5, 2, 1, 1,"zOmuonP+zOkaonP"               ,    9.99521,    0.72788,    4.00682,    0.85791,    1.00000} },{
	{ 5, 2, 2, 0,"zImuon+zIkaon"                 ,    9.95485,    0.73036,    3.44470,    0.45951,    1.00000},
	{ 5, 2, 2, 1,"zOmuon+zOkaon"                 ,   10.67440,    0.73413,    4.02403,    0.83713,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 5, 3, 0, 0,"zImuonN+zIelectronN"           ,    9.27158,    0.68903,    3.43266,    0.52362,    1.00000},
	{ 5, 3, 0, 1,"zOmuonN+zOelectronN"           ,   10.01179,    0.67669,    4.02082,    0.85303,    1.00000} },{
	{ 5, 3, 1, 0,"zImuonP+zIelectronP"           ,    9.34074,    0.65253,    3.47245,    0.52368,    1.00000},
	{ 5, 3, 1, 1,"zOmuonP+zOelectronP"           ,   10.01826,    0.65999,    4.01869,    0.87533,    1.00000} },{
	{ 5, 3, 2, 0,"zImuon+zIelectron"             ,   10.01672,    0.66908,    3.45458,    0.54616,    1.00000},
	{ 5, 3, 2, 1,"zOmuon+zOelectron"             ,   10.66044,    0.66585,    4.02177,    0.82729,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 5, 4, 0, 0,""                              ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000},
	{ 5, 4, 0, 1,""                              ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000} },{
	{ 5, 4, 1, 0,"zImuonP+zIdeuteronP"           ,   10.79498,    2.03021,    5.67647,    1.43120,    1.00000},
	{ 5, 4, 1, 1,"zOmuonP+zOdeuteronP"           ,   11.36749,    2.01680,    7.31368,    1.47958,    1.00000} },{
	{ 5, 4, 2, 0,"zImuon+zIdeuteron"             ,   11.43905,    2.03332,    5.65242,    1.42143,    1.00000},
	{ 5, 4, 2, 1,"zOmuon+zOdeuteron"             ,   12.06567,    2.01769,    7.29189,    1.47586,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 5, 5, 0, 0,"zImuonN+zImuonN"               ,    9.22057,    0.57472,    3.15120,    0.45838,    1.00000},
	{ 5, 5, 0, 1,"zOmuonN+zOmuonN"               ,    9.79951,    0.52488,    3.74939,    0.68009,    1.00000} },{
	{ 5, 5, 1, 0,"zImuonP+zImuonP"               ,    9.30018,    0.52946,    3.18523,    0.47495,    1.00000},
	{ 5, 5, 1, 1,"zOmuonP+zOmuonP"               ,    9.84433,    0.50466,    3.75086,    0.74439,    1.00000} },{
	{ 5, 5, 2, 0,"zImuon+zImuon"                 ,    9.93635,    0.54979,    3.18426,    0.44024,    1.00000},
	{ 5, 5, 2, 1,"zOmuon+zOmuon"                 ,   10.53050,    0.51533,    3.74543,    0.72748,    1.00000} }},
  };
#if 0
  static MIPFitParG_t parMIPs[27][3][2] = {
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 0,-1, 0, 0,"zIpionN"               ,    9.14142,   -0.21628,    2.54452,    0.45379,    1.00000},
	{ 0,-1, 0, 1,"zOpionN"               ,    9.75809,   -0.24376,    2.94731,    0.72270,    1.00000} },{
	{ 0,-1, 1, 0,"zIpionP"               ,    9.29170,   -0.25715,    2.57000,    0.48993,    1.00000},
	{ 0,-1, 1, 1,"zOpionP"               ,    9.80002,   -0.26689,    2.93394,    0.74102,    1.00000} },{
	{ 0,-1, 2, 0,"zIpion"                ,    9.91253,   -0.23821,    2.55491,    0.47355,    1.00000},
	{ 0,-1, 2, 1,"zOpion"                ,   10.47574,   -0.25517,    2.93869,    0.73568,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 1,-1, 0, 0,"zIprotonN"             ,   10.31367,    0.87248,    3.67609,    1.05217,    1.00000},
	{ 1,-1, 0, 1,"zOprotonN"             ,   10.51738,    0.97325,    4.00515,    1.31405,    1.00000} },{
	{ 1,-1, 1, 0,"zIprotonP"             ,   10.26744,    0.86346,    3.67953,    1.04595,    1.00000},
	{ 1,-1, 1, 1,"zOprotonP"             ,   10.42140,    0.96872,    4.01845,    1.29871,    1.00000} },{
	{ 1,-1, 2, 0,"zIproton"              ,   10.98971,    0.86826,    3.68369,    1.05309,    1.00000},
	{ 1,-1, 2, 1,"zOproton"              ,   11.16469,    0.97114,    4.01164,    1.30737,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 2,-1, 0, 0,"zIkaonN"               ,    9.63694,    0.13341,    2.93466,    0.58884,    1.00000},
	{ 2,-1, 0, 1,"zOkaonN"               ,   10.07930,    0.16954,    3.33318,    0.86899,    1.00000} },{
	{ 2,-1, 1, 0,"zIkaonP"               ,    9.66048,    0.10783,    2.95937,    0.60155,    1.00000},
	{ 2,-1, 1, 1,"zOkaonP"               ,   10.00915,    0.15799,    3.31241,    0.87946,    1.00000} },{
	{ 2,-1, 2, 0,"zIkaon"                ,   10.34618,    0.12068,    2.94741,    0.60081,    1.00000},
	{ 2,-1, 2, 1,"zOkaon"                ,   10.74004,    0.16412,    3.32274,    0.87576,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 3,-1, 0, 0,"zIelectronN"           ,    9.62711,    0.02036,    2.95747,    0.57639,    1.00000},
	{ 3,-1, 0, 1,"zOelectronN"           ,   10.12671,    0.05269,    3.32954,    0.87497,    1.00000} },{
	{ 3,-1, 1, 0,"zIelectronP"           ,    9.77843,   -0.00430,    2.96260,    0.63743,    1.00000},
	{ 3,-1, 1, 1,"zOelectronP"           ,   10.17430,    0.04205,    3.31083,    0.90705,    1.00000} },{
	{ 3,-1, 2, 0,"zIelectron"            ,   10.40735,    0.00811,    2.95602,    0.62028,    1.00000},
	{ 3,-1, 2, 1,"zOelectron"            ,   10.84539,    0.04754,    3.31734,    0.89262,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 4,-1, 0, 0,"zIdeuteronN"           ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000},
	{ 4,-1, 0, 1,"zOdeuteronN"           ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000} },{
	{ 4,-1, 1, 0,"zIdeuteronP"           ,    9.68242,    1.88943,    5.42909,    1.62022,    1.00000},
	{ 4,-1, 1, 1,"zOdeuteronP"           ,    8.46010,    1.88133,    7.27942,    1.57080,    1.00000} },{
	{ 4,-1, 2, 0,"zIdeuteron"            ,    9.68242,    1.88943,    5.42909,    1.62022,    1.00000},
	{ 4,-1, 2, 1,"zOdeuteron"            ,    8.46010,    1.88133,    7.27942,    1.57080,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 5,-1, 0, 0,"zImuonN"               ,    9.19539,   -0.21310,    2.56015,    0.44506,    1.00000},
	{ 5,-1, 0, 1,"zOmuonN"               ,    9.79412,   -0.23633,    2.95445,    0.71725,    1.00000} },{
	{ 5,-1, 1, 0,"zImuonP"               ,    9.29179,   -0.25293,    2.59072,    0.49283,    1.00000},
	{ 5,-1, 1, 1,"zOmuonP"               ,    9.79974,   -0.25777,    2.95584,    0.74854,    1.00000} },{
	{ 5,-1, 2, 0,"zImuon"                ,    9.93622,   -0.23402,    2.57271,    0.46765,    1.00000},
	{ 5,-1, 2, 1,"zOmuon"                ,   10.49324,   -0.24664,    2.95269,    0.73644,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 0, 0, 0, 0,"zIpionN+zIpionN"       ,    9.11904,    0.56847,    3.12111,    0.38270,    1.00000},
	{ 0, 0, 0, 1,"zOpionN+zOpionN"       ,    9.84720,    0.52267,    3.72706,    0.76332,    1.00000} },{
	{ 0, 0, 1, 0,"zIpionP+zIpionP"       ,    9.24748,    0.52570,    3.14539,    0.38118,    1.00000},
	{ 0, 0, 1, 1,"zOpionP+zOpionP"       ,    9.82918,    0.49467,    3.71447,    0.72337,    1.00000} },{
	{ 0, 0, 2, 0,"zIpion+zIpion"         ,    9.89534,    0.54543,    3.15510,    0.41585,    1.00000},
	{ 0, 0, 2, 1,"zOpion+zOpion"         ,   10.50756,    0.50725,    3.72337,    0.72155,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 1, 0, 0, 0,"zIprotonN+zIpionN"     ,   10.22660,    1.22368,    4.03675,    0.96415,    1.00000},
	{ 1, 0, 0, 1,"zOprotonN+zOpionN"     ,   10.51738,    1.27439,    4.58011,    1.24215,    1.00000} },{
	{ 1, 0, 1, 0,"zIprotonP+zIpionP"     ,   10.20101,    1.20415,    4.09384,    0.97067,    1.00000},
	{ 1, 0, 1, 1,"zOprotonP+zOpionP"     ,   10.41013,    1.26534,    4.57627,    1.22501,    1.00000} },{
	{ 1, 0, 2, 0,"zIproton+zIpion"       ,   10.92672,    1.21296,    4.10062,    0.98012,    1.00000},
	{ 1, 0, 2, 1,"zOproton+zOpion"       ,   11.16402,    1.27034,    4.57770,    1.23790,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 1, 1, 0, 0,"zIprotonN+zIprotonN"   ,   10.57570,    1.61480,    4.82817,    1.13828,    1.00000},
	{ 1, 1, 0, 1,"zOprotonN+zOprotonN"   ,   10.84423,    1.70231,    5.24332,    1.39313,    1.00000} },{
	{ 1, 1, 1, 0,"zIprotonP+zIprotonP"   ,   10.52521,    1.60712,    4.80227,    1.13193,    1.00000},
	{ 1, 1, 1, 1,"zOprotonP+zOprotonP"   ,   10.75612,    1.69889,    5.22653,    1.38809,    1.00000} },{
	{ 1, 1, 2, 0,"zIproton+zIproton"     ,   11.25445,    1.61163,    4.82842,    1.14144,    1.00000},
	{ 1, 1, 2, 1,"zOproton+zOproton"     ,   11.49218,    1.70106,    5.23533,    1.38866,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 2, 0, 0, 0,"zIkaonN+zIpionN"       ,    9.56220,    0.74700,    3.40273,    0.46497,    1.00000},
	{ 2, 0, 0, 1,"zOkaonN+zOpionN"       ,   10.11094,    0.74092,    4.02823,    0.85345,    1.00000} },{
	{ 2, 0, 1, 0,"zIkaonP+zIpionP"       ,    9.60684,    0.71315,    3.45213,    0.51043,    1.00000},
	{ 2, 0, 1, 1,"zOkaonP+zOpionP"       ,   10.01144,    0.72299,    3.98696,    0.84044,    1.00000} },{
	{ 2, 0, 2, 0,"zIkaon+zIpion"         ,   10.23504,    0.72679,    3.43510,    0.42266,    1.00000},
	{ 2, 0, 2, 1,"zOkaon+zOpion"         ,   10.74996,    0.73223,    3.99391,    0.84337,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 2, 1, 0, 0,"zIkaonN+zIprotonN"     ,   10.12827,    1.31920,    4.28799,    0.95789,    1.00000},
	{ 2, 1, 0, 1,"zOkaonN+zOprotonN"     ,   10.80836,    1.38635,    4.80306,    1.25605,    1.00000} },{
	{ 2, 1, 1, 0,"zIkaonP+zIprotonP"     ,   10.15202,    1.30500,    4.29286,    0.96514,    1.00000},
	{ 2, 1, 1, 1,"zOkaonP+zOprotonP"     ,   10.70371,    1.38013,    4.79708,    1.24224,    1.00000} },{
	{ 2, 1, 2, 0,"zIkaon+zIproton"       ,   10.85041,    1.31242,    4.29101,    0.97323,    1.00000},
	{ 2, 1, 2, 1,"zOkaon+zOproton"       ,   11.45380,    1.38252,    4.81032,    1.25101,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 2, 2, 0, 0,"zIkaonN+zIkaonN"       ,    9.63031,    0.89992,    3.66934,    0.54954,    1.00000},
	{ 2, 2, 0, 1,"zOkaonN+zOkaonN"       ,   10.20806,    0.92085,    4.28177,    0.91285,    1.00000} },{
	{ 2, 2, 1, 0,"zIkaonP+zIkaonP"       ,    9.65557,    0.87351,    3.69460,    0.56340,    1.00000},
	{ 2, 2, 1, 1,"zOkaonP+zOkaonP"       ,   10.12056,    0.90823,    4.26136,    0.90920,    1.00000} },{
	{ 2, 2, 2, 0,"zIkaon+zIkaon"         ,   10.36532,    0.88678,    3.72092,    0.59209,    1.00000},
	{ 2, 2, 2, 1,"zOkaon+zOkaon"         ,   10.87472,    0.91549,    4.28186,    0.92222,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 3, 0, 0, 0,"zIelectronN+zIpionN"   ,    9.55700,    0.68375,    3.40616,    0.45703,    1.00000},
	{ 3, 0, 0, 1,"zOelectronN+zOpionN"   ,   10.16372,    0.67439,    4.02091,    0.86299,    1.00000} },{
	{ 3, 0, 1, 0,"zIelectronP+zIpionP"   ,    9.68348,    0.64807,    3.47008,    0.49330,    1.00000},
	{ 3, 0, 1, 1,"zOelectronP+zOpionP"   ,   10.18801,    0.65639,    3.99877,    0.87350,    1.00000} },{
	{ 3, 0, 2, 0,"zIelectron+zIpion"     ,   10.32948,    0.66538,    3.43078,    0.49720,    1.00000},
	{ 3, 0, 2, 1,"zOelectron+zOpion"     ,   10.84347,    0.66395,    4.01456,    0.84859,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 3, 1, 0, 0,"zIelectronN+zIprotonN" ,   10.22296,    1.28682,    4.29842,    1.02079,    1.00000},
	{ 3, 1, 0, 1,"zOelectronN+zOprotonN" ,   10.88211,    1.35323,    4.77506,    1.27950,    1.00000} },{
	{ 3, 1, 1, 0,"zIelectronP+zIprotonP" ,   10.33967,    1.27200,    4.33172,    1.02983,    1.00000},
	{ 3, 1, 1, 1,"zOelectronP+zOprotonP" ,   10.89640,    1.34854,    4.76228,    1.28250,    1.00000} },{
	{ 3, 1, 2, 0,"zIelectron+zIproton"   ,   10.98103,    1.28074,    4.30748,    1.02895,    1.00000},
	{ 3, 1, 2, 1,"zOelectron+zOproton"   ,   11.57645,    1.34924,    4.77131,    1.27665,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 3, 2, 0, 0,"zIelectronN+zIkaonN"   ,    9.68949,    0.84762,    3.70208,    0.61789,    1.00000},
	{ 3, 2, 0, 1,"zOelectronN+zOkaonN"   ,   10.23821,    0.86318,    4.29569,    0.90470,    1.00000} },{
	{ 3, 2, 1, 0,"zIelectronP+zIkaonP"   ,    9.78248,    0.81895,    3.72418,    0.60666,    1.00000},
	{ 3, 2, 1, 1,"zOelectronP+zOkaonP"   ,   10.24795,    0.84941,    4.26589,    0.90483,    1.00000} },{
	{ 3, 2, 2, 0,"zIelectron+zIkaon"     ,   10.38546,    0.83122,    3.71052,    0.56133,    1.00000},
	{ 3, 2, 2, 1,"zOelectron+zOkaon"     ,   10.96045,    0.85782,    4.27403,    0.92218,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 3, 3, 0, 0,"zIelectronN+zIelectronN",    9.66196,    0.78995,    3.72340,    0.58801,    1.00000},
	{ 3, 3, 0, 1,"zOelectronN+zOelectronN",   10.30024,    0.80689,    4.29393,    0.94830,    1.00000} },{
	{ 3, 3, 1, 0,"zIelectronP+zIelectronP",    9.82908,    0.76339,    3.73965,    0.65719,    1.00000},
	{ 3, 3, 1, 1,"zOelectronP+zOelectronP",   10.32619,    0.79325,    4.27601,    0.95907,    1.00000} },{
	{ 3, 3, 2, 0,"zIelectron+zIelectron" ,   10.42680,    0.77502,    3.74200,    0.60922,    1.00000},
	{ 3, 3, 2, 1,"zOelectron+zOelectron" ,   11.00633,    0.80062,    4.28333,    0.95391,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 4, 0, 0, 0,""                      ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000},
	{ 4, 0, 0, 1,""                      ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000} },{
	{ 4, 0, 1, 0,"zIdeuteronP+zIpionP"   ,    9.64523,    2.03234,    5.65867,    1.42861,    1.00000},
	{ 4, 0, 1, 1,"zOdeuteronP+zOpionP"   ,    8.41461,    2.01650,    7.31553,    1.47382,    1.00000} },{
	{ 4, 0, 2, 0,"zIdeuteron+zIpion"     ,    9.61392,    2.03084,    5.68875,    1.40032,    1.00000},
	{ 4, 0, 2, 1,"zOdeuteron+zOpion"     ,    8.42454,    2.01807,    7.33704,    1.48393,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 4, 1, 0, 0,""                      ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000},
	{ 4, 1, 0, 1,""                      ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000} },{
	{ 4, 1, 1, 0,"zIdeuteronP+zIprotonP" ,    9.73549,    2.22523,    6.17298,    1.43775,    1.00000},
	{ 4, 1, 1, 1,"zOdeuteronP+zOprotonP" ,    8.48654,    2.23596,    7.67219,    1.49681,    1.00000} },{
	{ 4, 1, 2, 0,"zIdeuteron+zIproton"   ,    9.72457,    2.22487,    6.15565,    1.43100,    1.00000},
	{ 4, 1, 2, 1,"zOdeuteron+zOproton"   ,    8.47633,    2.23442,    7.73429,    1.48080,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 4, 2, 0, 0,""                      ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000},
	{ 4, 2, 0, 1,""                      ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000} },{
	{ 4, 2, 1, 0,"zIdeuteronP+zIkaonP"   ,    9.64475,    2.07634,    5.78030,    1.41294,    1.00000},
	{ 4, 2, 1, 1,"zOdeuteronP+zOkaonP"   ,    8.43029,    2.07354,    7.33849,    1.48361,    1.00000} },{
	{ 4, 2, 2, 0,"zIdeuteron+zIkaon"     ,    9.65300,    2.07878,    5.77475,    1.42034,    1.00000},
	{ 4, 2, 2, 1,"zOdeuteron+zOkaon"     ,    8.41406,    2.06944,    7.53880,    1.45103,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 4, 3, 0, 0,""                      ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000},
	{ 4, 3, 0, 1,""                      ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000} },{
	{ 4, 3, 1, 0,"zIdeuteronP+zIelectronP",    9.68343,    2.05773,    5.82941,    1.43788,    1.00000},
	{ 4, 3, 1, 1,"zOdeuteronP+zOelectronP",    8.46226,    2.05391,    7.51260,    1.49538,    1.00000} },{
	{ 4, 3, 2, 0,"zIdeuteron+zIelectron" ,    9.68187,    2.06223,    5.76550,    1.44483,    1.00000},
	{ 4, 3, 2, 1,"zOdeuteron+zOelectron" ,    8.46554,    2.05224,    7.56544,    1.65002,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 4, 4, 0, 0,""                      ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000},
	{ 4, 4, 0, 1,""                      ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000} },{
	{ 4, 4, 1, 0,"zIdeuteronP+zIdeuteronP",   10.00785,    2.59098,    7.47962,    1.53821,    1.00000},
	{ 4, 4, 1, 1,"zOdeuteronP+zOdeuteronP",    8.77993,    2.57945,   10.00000,    1.57080,    1.00000} },{
	{ 4, 4, 2, 0,"zIdeuteron+zIdeuteron" ,   10.01160,    2.59161,    7.52530,    1.60747,    1.00000},
	{ 4, 4, 2, 1,"zOdeuteron+zOdeuteron" ,    8.77413,    2.57892,    9.93971,    1.57080,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 5, 0, 0, 0,"zImuonN+zIpionN"       ,    9.18822,    0.57110,    3.15029,    0.40675,    1.00000},
	{ 5, 0, 0, 1,"zOmuonN+zOpionN"       ,    9.84548,    0.52308,    3.73651,    0.72425,    1.00000} },{
	{ 5, 0, 1, 0,"zImuonP+zIpionP"       ,    9.28208,    0.52729,    3.18523,    0.44772,    1.00000},
	{ 5, 0, 1, 1,"zOmuonP+zOpionP"       ,    9.81902,    0.49927,    3.73471,    0.72195,    1.00000} },{
	{ 5, 0, 2, 0,"zImuon+zIpion"         ,    9.93517,    0.54857,    3.15743,    0.43884,    1.00000},
	{ 5, 0, 2, 1,"zOmuon+zOpion"         ,   10.51158,    0.51058,    3.73187,    0.71039,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 5, 1, 0, 0,"zImuonN+zIprotonN"     ,    9.79394,    1.22356,    4.06043,    0.96890,    1.00000},
	{ 5, 1, 0, 1,"zOmuonN+zOprotonN"     ,   10.65280,    1.27646,    4.59912,    1.23759,    1.00000} },{
	{ 5, 1, 1, 0,"zImuonP+zIprotonP"     ,    9.85416,    1.20372,    4.08162,    0.96283,    1.00000},
	{ 5, 1, 1, 1,"zOmuonP+zOprotonP"     ,   10.63993,    1.26953,    4.59536,    1.24528,    1.00000} },{
	{ 5, 1, 2, 0,"zImuon+zIproton"       ,   10.49623,    1.21185,    4.08678,    0.94996,    1.00000},
	{ 5, 1, 2, 1,"zOmuon+zOproton"       ,   11.33064,    1.27190,    4.57985,    1.23708,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 5, 2, 0, 0,"zImuonN+zIkaonN"       ,    9.29526,    0.75297,    3.42458,    0.55477,    1.00000},
	{ 5, 2, 0, 1,"zOmuonN+zOkaonN"       ,    9.99806,    0.74357,    4.03146,    0.84110,    1.00000} },{
	{ 5, 2, 1, 0,"zImuonP+zIkaonP"       ,    9.29833,    0.71470,    3.44825,    0.46374,    1.00000},
	{ 5, 2, 1, 1,"zOmuonP+zOkaonP"       ,    9.99521,    0.72788,    4.00682,    0.85791,    1.00000} },{
	{ 5, 2, 2, 0,"zImuon+zIkaon"         ,    9.95485,    0.73036,    3.44470,    0.45951,    1.00000},
	{ 5, 2, 2, 1,"zOmuon+zOkaon"         ,   10.67440,    0.73413,    4.02403,    0.83713,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 5, 3, 0, 0,"zImuonN+zIelectronN"   ,    9.27158,    0.68903,    3.43266,    0.52362,    1.00000},
	{ 5, 3, 0, 1,"zOmuonN+zOelectronN"   ,   10.01179,    0.67669,    4.02082,    0.85303,    1.00000} },{
	{ 5, 3, 1, 0,"zImuonP+zIelectronP"   ,    9.34074,    0.65253,    3.47245,    0.52368,    1.00000},
	{ 5, 3, 1, 1,"zOmuonP+zOelectronP"   ,   10.01826,    0.65999,    4.01869,    0.87533,    1.00000} },{
	{ 5, 3, 2, 0,"zImuon+zIelectron"     ,   10.01672,    0.66908,    3.45458,    0.54616,    1.00000},
	{ 5, 3, 2, 1,"zOmuon+zOelectron"     ,   10.66044,    0.66585,    4.02177,    0.82729,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 5, 4, 0, 0,""                      ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000},
	{ 5, 4, 0, 1,""                      ,    0.00000,    0.00000,    0.00000,    0.00000,    0.00000} },{
	{ 5, 4, 1, 0,"zImuonP+zIdeuteronP"   ,   10.79498,    2.03021,    5.67647,    1.43120,    1.00000},
	{ 5, 4, 1, 1,"zOmuonP+zOdeuteronP"   ,   11.36749,    2.01680,    7.31368,    1.47958,    1.00000} },{
	{ 5, 4, 2, 0,"zImuon+zIdeuteron"     ,   11.43905,    2.03332,    5.65242,    1.42143,    1.00000},
	{ 5, 4, 2, 1,"zOmuon+zOdeuteron"     ,   12.06567,    2.01769,    7.29189,    1.47586,    1.00000} }},
    {{ // particle, norml, mu, sigmaI, phase, sigmaG
	{ 5, 5, 0, 0,"zImuonN+zImuonN"       ,    9.22057,    0.57472,    3.15120,    0.45838,    1.00000},
	{ 5, 5, 0, 1,"zOmuonN+zOmuonN"       ,    9.79951,    0.52488,    3.74939,    0.68009,    1.00000} },{
	{ 5, 5, 1, 0,"zImuonP+zImuonP"       ,    9.30018,    0.52946,    3.18523,    0.47495,    1.00000},
	{ 5, 5, 1, 1,"zOmuonP+zOmuonP"       ,    9.84433,    0.50466,    3.75086,    0.74439,    1.00000} },{
	{ 5, 5, 2, 0,"zImuon+zImuon"         ,    9.93635,    0.54979,    3.18426,    0.44024,    1.00000},
	{ 5, 5, 2, 1,"zOmuon+zOmuon"         ,   10.53050,    0.51533,    3.74543,    0.72748,    1.00000} }}
  };
#endif
  static Double_t MuShiftIO[3] = {0}; //-7.98670e-02, 6.43941e-03, 0}; // Aerage for sectors for 7p7GeV_2021
  Double_t Value = 0;
  Int_t icase = (Int_t) par[12];
  Int_t i1 = 0;
  Int_t i2 = Npart4EG - 1;
  if (icase >= 0) {i1 = i2 = icase;}
  TF1 *g = StdEdxModel::instance()->ExValG();
  static Int_t _debug = 0;
  for (Int_t i = i1; i <= i2; i++) { 
    if (frac[i] <= 0.0) continue;
    //    Double_t Mu = (mu + parMIPs[i][sign][IO].mu - parMIPs[0][sign][IO].mu)/(scale + MuShiftIO[IO]);
    //    Double_t Mu = (mu + parMIPs[i][sign][IO].mu - parMIPs[0][0][IO].mu)/(scale + MuShiftIO[IO]);
    Double_t Mu = (mu + parMIPs[i][sign][IO].mu - parMIPs[0][0][IO].mu)/(scale + MuShiftIO[IO]);
    //    Double_t Mu = mu + parMIPs[i][sign][IO].mu;
    Double_t pars[5] = {0, Mu, parMIPs[i][sign][IO].sigmaI, parMIPs[i][sign][IO].phase, parMIPs[i][sign][IO].sigmaG};
    Value += frac[i]*g->EvalPar(XX, pars);
    if (_debug) {
      cout << "i: " << i << " " << parMIPs[i][sign][IO].Name << " frac[" << i <<"] = " << frac[i] << "\t"; parMIPs[i][sign][IO].Print("",pars);
    }
  }
  if (occupancy > 0) {
    Double_t overlap = 0;
    for (Int_t i = i1; i <= i2; i++) { 
      if (frac[i] <= 0.0) continue;
      Double_t cont = 0;
      for (Int_t j = 0; j < Npart4EG; j++) {
	if (frac[j] <= 0.0) continue;
	Int_t l = (i <= j) ? i + j*(j+1)/2 : j + i*(i+1)/2;
	l += Npart4EG;
	//	Double_t Mu =      (mu    + parMIPs[l][sign][IO].mu     - parMIPs[0][sign][IO].mu)/(scale + MuShiftIO[IO]);
	Double_t Mu =      (mu    + parMIPs[l][sign][IO].mu     - parMIPs[0][0][IO].mu)/(scale + MuShiftIO[IO]);
	//	Double_t Mu = mu + parMIPs[l][sign][IO].mu;
	Double_t pars[5] = {0, Mu, parMIPs[l][sign][IO].sigmaI, parMIPs[l][sign][IO].phase, parMIPs[l][sign][IO].sigmaG}; 
	cont += frac[j]*g->EvalPar(XX, pars);
	if (_debug) {
	  cout << "i:" << i << " " << parMIPs[i][sign][IO].Name << "\t+ j:" << j << " " <<  parMIPs[j][sign][IO].Name << "\t frac[" << j <<"] = " << frac[j] << "\t l:" << l << " "; parMIPs[l][sign][IO].Print("",pars);
	}
      }
      overlap += frac[i]*cont;
    }
    Value += occupancy*overlap;
  }
  return par[11]*TMath::Exp(par[0])*Value;
}
//________________________________________________________________________________
Bool_t  PreSetParametersG(TH1 *proj, TF1 *g2) { // Fit peak nearest to 0 by gaus
  if (! proj || ! g2) return kFALSE;
  static TSpectrum *fSpectrum = 0;
  if (! fSpectrum) {
    fSpectrum = new TSpectrum(6);
  }
  // Find pion peak
  Int_t nfound = fSpectrum->Search(proj);
  Int_t NN = nfound + 1;
#if  ROOT_VERSION_CODE < ROOT_VERSION(6,0,0)
  TArrayF X(NN,fSpectrum->GetPositionX());
  TArrayF Y(NN,fSpectrum->GetPositionY());
#else
  TArrayD X(NN,fSpectrum->GetPositionX());
  TArrayD Y(NN,fSpectrum->GetPositionY());
#endif
  TArrayI idxT(NN);
  Int_t nP = 0;
  //                             pi,        proton,          kaon,             e,     deuteron, 
  Double_t frac[5] = {           1.,          1e-6,          1e-6,          1e-6,          1e-6};
  Double_t post[5] = {Peaks[0].peak, Peaks[1].peak, Peaks[2].peak, Peaks[3].peak, Peaks[4].peak};
  Double_t T = 0;
  Double_t tots[5] = {0};
  Double_t xpiPd[3] = {0};
  Double_t ypiPd[3] = {0};
  Double_t ppiPd[3] = {Peaks[0].peak, Peaks[1].peak, Peaks[4].peak};
  Double_t shift = 0;
  Double_t total = 0;
  if (nfound > 0) {
    TMath::Sort(nfound,X.GetArray(),idxT.GetArray(),kFALSE);
    for (Int_t i = 0; i < nfound; i++) {
      Int_t p = idxT[i];
      Double_t xp = X[p];
      Int_t bin = proj->GetXaxis()->FindBin(xp);
      Double_t yp = proj->GetBinContent(bin);
      Double_t ep = proj->GetBinError(bin);
      if (yp-5*ep < 0) continue;
      // take only peak associated with pion, proton and deuteron
      xpiPd[nP] = xp;
      ypiPd[nP] = yp;
      total += yp;
      shift += (xp - ppiPd[nP])*yp; 
      nP++;
      if (nP == 3) break;
    }
  }   
  if (nP > 0) {
    tots[0] = ypiPd[0];
    tots[1] = ypiPd[1];
    tots[5] = ypiPd[2];
    shift = shift/total;
    Double_t xpi = ppiPd[0] + shift;
    g2->SetParameters(1, xpi);
    for (Int_t l = 1; l < 5; l++) {
      if (tots[l] > 0) {
	frac[l] = tots[l]/total;
      }
      Double_t phi = TMath::ASin(TMath::Sqrt(frac[l]));
      g2->FixParameter(l+2, phi);
    }
  } else {// nP == 0 
    g2->SetParameters(1, proj->GetMean());
  }
  g2->SetParameter(2, 0.01);
  total = proj->Integral()*proj->GetBinWidth(5);
  g2->FixParameter(11, total);
  return kTRUE;
}
//________________________________________________________________________________
TF1 *FitG4EG(TH1 *proj, Option_t *opt="RM", Int_t IO = 0, Int_t Sign = 2) {
  // fit in momentum range p = 0.526 +/- 0.05;
  //  Sign = 2; // <<<<<<<<<<<<!!!!!!!!!
  if (! proj) return 0;
  TString Opt(opt);
  //  Bool_t quet = Opt.Contains("Q",TString::kIgnoreCase);
  TF1 *g2 = (TF1*) gROOT->GetFunction("G4EG");
  if (! g2) {
    g2 = new TF1("G4EG",gf4EGFunc, -5, 5, 17);
    g2->SetParName(0,"norm");      g2->SetParLimits(0,-0.6,0.6); // g2->FixParameter(0,0.0); // 
    g2->SetParName(1,"mu");        g2->SetParLimits(1,-0.8,0.4);				     
    g2->SetParName(2,"Sigma");     g2->FixParameter(2,0.0); g2->SetParLimits(2,-0.1,0.1);	     
    g2->SetParName(3,"P");         g2->SetParLimits(3,0.0,1.2); // TMath::Pi()/2);		     
    g2->SetParName(4,"K");         g2->SetParLimits(4,0.0,1.0); // TMath::Pi()/2); 	     
    g2->SetParName(5,"e");         g2->SetParLimits(5,0.0,TMath::Pi()/2);			     
    g2->SetParName(6,"d");         g2->SetParLimits(6,0.0, 1.0); // TMath::Pi()/2);             
    g2->SetParName(7,"muon");      g2->SetParLimits(7,0.0, 1.0); // TMath::Pi()/2);             
    g2->SetParName(8,"triton");    g2->SetParLimits(8,0.0, 1.0); // TMath::Pi()/2);             
    g2->SetParName(9,"He3");       g2->SetParLimits(9,0.0, 1.0); // TMath::Pi()/2);             
    g2->SetParName(10,"alpha");    g2->SetParLimits(10,0.0, 1.0); // TMath::Pi()/2);             
    g2->SetParName(11,"Total");
    g2->SetParName(12,"Case");
    g2->SetParName(13,"occupancy"); g2->FixParameter(13,0); g2->SetParLimits(13,0.0,0.25);
    g2->SetParName(14,"IO");       g2->FixParameter(14,IO); 
    g2->SetParName(15,"sign");     g2->FixParameter(15,Sign); 
    g2->SetParName(16,"Scale"); g2->FixParameter(16,0.0); g2->SetParLimits(16,-0.1,0.1);
    //    g2->SetParName(15,"factor"); g2->SetParLimits(15,-.1,0.1);
  }
  PreSetParametersG(proj, g2);
  //  g2->ReleaseParameter(2);  g2->SetParLimits(2,-0.1,0.1);
  g2->FixParameter(2, 0);
  g2->ReleaseParameter(3);  g2->SetParLimits(3,0.0,TMath::Pi()/2);
  g2->FixParameter(4,0.01); 
  g2->FixParameter(5,0.01);
  g2->FixParameter(6,0.01);
  g2->FixParameter(7,0.00);
  g2->FixParameter(8,0.00);
  g2->FixParameter(9,0.00);
  g2->FixParameter(10,0.0);
  g2->FixParameter(12,-1);
  g2->FixParameter(13,0.);
  g2->FixParameter(14,IO); 
  g2->FixParameter(15,Sign); 
  g2->FixParameter(16,0.0);
  //  Fit pion + proton 
  proj->Fit(g2,Opt.Data());
  g2->ReleaseParameter(4);     g2->SetParLimits(4,0.0,TMath::Pi()/2); 
  g2->ReleaseParameter(5);     g2->SetParLimits(5,0.0,TMath::Pi()/2);		
  g2->ReleaseParameter(6);     g2->SetParLimits(6,0.0,TMath::Pi()/2);
  //  Fit pion + proton + K + e + d
  Int_t iok = proj->Fit(g2,Opt.Data());
  if ( iok < 0) {
    cout << g2->GetName() << " fit has failed with " << iok << " for " 
	 << proj->GetName() << "/" << proj->GetTitle() << " Try one again" << endl; 
    proj->Fit(g2,Opt.Data());
  }
#if defined(__ELOSS__) || defined(__SCALE__)
  g2->ReleaseParameter(16); g2->SetParLimits(16,-0.1,0.1);
  iok = proj->Fit(g2,Opt.Data());
#endif
  //  g2->ReleaseParameter(7);     g2->SetParLimits(4,0.0,0.6); // TMath::Pi()/2); 
  g2->ReleaseParameter(8);     g2->SetParLimits(8,0.0,TMath::Pi()/2);		
  //  g2->ReleaseParameter(9);     g2->SetParLimits(6,0.0, 1.0); // TMath::Pi()/2);
  //  g2->ReleaseParameter(10);     g2->SetParLimits(6,0.0, 1.0); // TMath::Pi()/2);
  //  Fit pion + proton + K + e + d + mu + triton // + He3 + alpha
  iok = proj->Fit(g2,Opt.Data());
#if 0
  // + occupancy
  g2->ReleaseParameter(13); g2->SetParLimits(13,0.0,0.15);
  iok = proj->Fit(g2,Opt.Data());
  if ( iok < 0) {
    cout << g2->GetName() << " fit has failed with " << iok << " for " 
	 << proj->GetName() << "/" << proj->GetTitle() << " Try one again" << endl; 
    proj->Fit(g2,Opt.Data());
  }
#endif
  Opt += "m";
  iok = proj->Fit(g2,Opt.Data());
  if (iok < 0 ) return 0;
  Int_t fixit = 0;
  for (Int_t p = 3; p <= 10; p++) {
    Double_t par = g2->GetParameter(p);
    if (par != 0) {
      Double_t dpar = g2->GetParError(p);
      if (TMath::Abs(par) < dpar) {
	fixit++;
	g2->FixParameter(p, 0);
      }
    }
  }
  if (fixit) iok = proj->Fit(g2,Opt.Data());
  if (! Opt.Contains("q",TString::kIgnoreCase)) {
    Double_t params[20];
    g2->GetParameters(params);
    Double_t X = params[1];
    Double_t Y = TMath::Exp(params[0]);
    TPolyMarker *pm = new TPolyMarker(1, &X, &Y);
    proj->GetListOfFunctions()->Add(pm);
    pm->SetMarkerStyle(23);
    pm->SetMarkerColor(kRed);
    pm->SetMarkerSize(1.3);
    Double_t occupancy = params[13];
    for (int i = 0; i < Npart4EG; i++) {
      Double_t frac = 1.0;
      if (i > 0) frac = TMath::Power(TMath::Sin(g2->GetParameter(2+i)), 2);
      if (frac < 1e-3) continue;
      TF1 *f = new TF1(*g2);
      static const Char_t *pnames[9] = {"pion", "P", "K", "e", "d", "muon", "t", "He3", "alpha"};
      f->SetName(pnames[i]);
      f->FixParameter(12,i);
      f->SetLineColor(i+2);
      proj->GetListOfFunctions()->Add(f);
      if (occupancy > 0) {
	TF1 *f = new TF1(*g2);
	f->SetName(TString(Peaks[i].Name)+"C");
	f->FixParameter(12,i);
	f->FixParameter(13,0);
	f->SetLineColor(i+2);
	f->SetLineStyle(2);
	proj->GetListOfFunctions()->Add(f);
      }
    }
    proj->Draw();
  }
  return g2;
}
